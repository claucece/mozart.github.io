<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>2 Command Line Interface</TITLE><LINK href="ozdoc.css" rel="stylesheet" type="text/css"></HEAD><BODY><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node1.html#chapter.introduction">&lt;&lt; Prev</A></TD><TD><A href="index.html">- Up -</A></TD><TD><A href="node3.html#chapter.gui">Next &gt;&gt;</A></TD></TR></TABLE><DIV id="chapter.clui"><H1><A name="chapter.clui">2 Command Line Interface</A></H1><P>The command line interface of ozpm can create packages, install or uninstall them and display miscelaneous informations. Note that packages can't be created by the graphical interface of ozpm. This interface is particularly suited for creating batch files for complex operations.</P><P>The avalaible command lines are : </P><UL><LI><P><CODE>ozpm&nbsp;<SPAN class="keyword">--</SPAN>help</CODE> : displays a reminder of command lines.</P></LI><LI><P><CODE>ozpm&nbsp;<SPAN class="keyword">--</SPAN>install&nbsp;<SPAN class="keyword">--in</SPAN></CODE> <EM>file</EM> <CODE><SPAN class="keyword">--</SPAN>force</CODE> : installs the package contained in <EM>file</EM>. <EM>file</EM> must be a valid <EM>.pkg</EM> package file previously created by ozpm. ozpm will check if the installation of this package conflicts with another installed package or a previous installation of this particular package. If there is a conflict and the <CODE><SPAN class="keyword">--</SPAN>force</CODE> parameter <EM>is not</EM> specified, a report of the conflict is displayed and the package is <EM>not</EM> installed. If there is a conflict and the <CODE><SPAN class="keyword">--</SPAN>force</CODE> parameter <EM>is</EM> specified, the conflict is ignored and the package is installed. Warning : use this with caution as forcing installations can mess packages.</P></LI><LI><P><CODE>ozpm&nbsp;<SPAN class="keyword">--</SPAN>remove&nbsp;<SPAN class="keyword">--in</SPAN></CODE> <EM>pkg</EM> : uninstall packages which id is <EM>pkg</EM>.</P></LI><LI><P><CODE>ozpm&nbsp;<SPAN class="keyword">--</SPAN>list</CODE> : lists all installed packages.</P></LI><LI><P><CODE>ozpm&nbsp;<SPAN class="keyword">--</SPAN>info&nbsp;<SPAN class="keyword">--in</SPAN></CODE> <EM>pkg</EM> : displays informations for the package referenced by <EM>pkg</EM> which can be : </P><UL><LI><P>the name of a package file on the disk (./bloblo.Pkg).</P></LI><LI><P>the id of an installed package (mogul:/blabla/bloblo).</P></LI></UL><P></P></LI><LI><P><CODE>ozpm&nbsp;<SPAN class="keyword">--</SPAN>check</CODE> : reports package system's integrity (not yet implemented).</P></LI><LI><P><CODE>ozpm&nbsp;<SPAN class="keyword">--</SPAN>create&nbsp;<SPAN class="keyword">--in</SPAN></CODE> <EM>pkgdescfile</EM> <CODE><SPAN class="keyword">--</SPAN>prefix</CODE> <EM>directory</EM> <CODE><SPAN class="keyword">--</SPAN>out</CODE> <EM>pkgfilename</EM> : creates a new package. See below for more informations.</P></LI></UL><P> </P><H2><A name="label1">2.1 Package creation</A></H2><P>An ozpm package file is a compressed file containing : </P><UL><LI><P>Informations about the package very like mogul informations.</P></LI><LI><P>A directory structure containing all package files.</P></LI></UL><P> The creation of a package involves specifying a text file containing the informations about the package (<CODE><SPAN class="keyword">--in</SPAN></CODE> parameter), a subdirectory containing all files of the package (<CODE><SPAN class="keyword">--</SPAN>prefix</CODE> parameter) and the package file name (<CODE><SPAN class="keyword">--</SPAN>out</CODE> parameter).</P><P>The package description text file must be formatted as follow : </P><UL><LI><P>The file is separated in two main parts : the parameter definition part and the body part. The definition part begins at the start of the file and continues up to an empty line. The body part starts at the line after the empty line up to the end of the file.</P></LI><LI><P>The definition part of the text file contains one parameter defined by line. A line is composed of the parameter's name, followed by the character <EM>:</EM>, followed by the parameter's value. Note that some parameters can be defined several time on different lines.</P></LI><LI><P>The body part of the text file is a textual definition of the package. This definition can be either pure ascii text or html text.</P></LI></UL><P> The package description text file can contain any parameter definition you might see fit, however there is a set of parameters are strictly required.</P><P>The set of parameters that are used by ozpm are : </P><UL><LI><P><CODE>id</CODE> : specifies the identifier of the package. If you have a Mogul id for this package, it is a good idea to specify that id. This parameter is required and can be specified only once.</P></LI><LI><P><CODE>author</CODE> : specifies the mogul id or alternatively the name of the author of the package. Not required.</P></LI><LI><P><CODE>version</CODE> : specifies the version number of the package. Not required.</P></LI><LI><P><CODE>blurb</CODE> : specifies a one line description of the package. Not required.</P></LI><LI><P><CODE>provides</CODE> : specifies the <EM>.ozf</EM> Oz module provided by the package. When a user tries to install a package requiring <EM>.ozf</EM> Oz modules, ozpm proposes to install the packages that provides these modules. Not strictly required, but strongly recommended if relevant. Can be specified several times if needed, one module per line.</P></LI><LI><P><CODE>requires</CODE> : specifies the <EM>.ozf</EM> Oz module required by the package. Ozpm can use this information to help user install the packages providing the required modules when installing this package. Not strictly required, but strongly recommended if relevant. Can be specified several times if needed, one module per line.</P></LI></UL><P> </P><H2><A name="label2">2.2 Easy way of creating packages with ozskel and mogul</A></H2><P>The best way to provide modules in Oz is to make them avalaible through URLs. This way anybody in the world connected to the internet can use it. Oz users can place these modules in their local Oz cache preventing the necessary download. The most efficient way of providing binary modules is to provide them ready to install in the user's local Oz cache. Using Mogul and ozpm, this is an easy task : </P><UL><LI><P>As you might have noticed, the package definition is similar enough to the mogul entry definition to use the same definition. Specify this file as the <CODE><SPAN class="keyword">--in</SPAN></CODE> parameter.</P></LI><LI><P>If you use ozskel, you can <CODE>make&nbsp;zip</CODE> to create a directory containing the <EM>.ozf</EM> oz modules provided by the package. This command creates an <EM>ozskel_tmpdir</EM> directory and a subdirectory named according to the id of the package. This directory contains the subdirectory structure and files that are to be included in the local Oz cache. Specify this directory as the <CODE><SPAN class="keyword">--</SPAN>prefix</CODE> parameter.</P></LI></UL><P> It is strongly recommended to use both these tools while creating binary packages.</P><P>If you have a mogul entry for your package and create an ozpm binary package for it, make it available in the mogul entry (use the url-pkg parameter). In such a case, the graphical user interface of ozpm will be able to directly install the binary package. Note that the ozpm binary package must have the <EM>.pkg</EM> extension. </P><H2><A name="label3">2.3 Example</A></H2><P>A user Toto that has the mogul id <EM>mogul:/toto</EM> created a package named <EM>dog</EM> and want to make it available to other users. He has access to a web site named <EM>www.toto.com</EM> where he decided to drop the mogul and package files along with the module file.</P><P>Toto has defined the mogul entry for the <EM>dog</EM> package like that : </P><BLOCKQUOTE class="code"><CODE>id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:mogul:<SPAN class="keyword">/</SPAN>toto<SPAN class="keyword">/</SPAN>dog<BR>url<SPAN class="keyword">-</SPAN>pkg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:http:<SPAN class="keyword">//</SPAN>www<SPAN class="keyword">.</SPAN>toto<SPAN class="keyword">.</SPAN>com<SPAN class="keyword">/</SPAN>dog<SPAN class="keyword">.</SPAN>tar<SPAN class="keyword">.</SPAN>Z<BR>url<SPAN class="keyword">-</SPAN>pkg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:http:<SPAN class="keyword">//</SPAN>www<SPAN class="keyword">.</SPAN>toto<SPAN class="keyword">.</SPAN>com<SPAN class="keyword">/</SPAN>dog<SPAN class="keyword">.</SPAN>pkg<BR>author&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:mogul:<SPAN class="keyword">/</SPAN>toto<SPAN class="keyword">/</SPAN>toto<BR>provides&nbsp;&nbsp;&nbsp;&nbsp;:http:<SPAN class="keyword">//</SPAN>www<SPAN class="keyword">.</SPAN>toto<SPAN class="keyword">.</SPAN>com<SPAN class="keyword">/</SPAN>Dog<SPAN class="keyword">.</SPAN>ozf<BR>content<SPAN class="keyword">-</SPAN>type:text<SPAN class="keyword">/</SPAN>html<BR>blurb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:A&nbsp;simple&nbsp;dog<BR>&nbsp;<BR>This&nbsp;very&nbsp;nice&nbsp;dog&nbsp;can&nbsp;easily&nbsp;attack&nbsp;intruders&nbsp;and&nbsp;protect&nbsp;your&nbsp;home<SPAN class="keyword">.</SPAN></CODE></BLOCKQUOTE><P> This entry was saved to the file named dogentry. Using oskel, Toto runs <EM>make zip</EM> to create a <EM>ozskel_tempdir</EM> containing a dictory named <EM>toto-dog</EM>. Toto can now create the dog.pkg file by the command :</P><P> <CODE>ozpm&nbsp;<SPAN class="keyword">--</SPAN>create&nbsp;<SPAN class="keyword">--in</SPAN>&nbsp;dogentry&nbsp;<SPAN class="keyword">--</SPAN>prefix&nbsp;ozskel_tempdir<SPAN class="keyword">/</SPAN>toto<SPAN class="keyword">-</SPAN>dog<SPAN class="keyword">/</SPAN>&nbsp;<SPAN class="keyword">--</SPAN>out&nbsp;dog<SPAN class="keyword">.</SPAN>pkg</CODE></P><P>Placing <EM>dogentry</EM> and <EM>dog.pkg</EM> onto his web server, Toto has successfully made his binary package available for all other users. </P></DIV><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node1.html#chapter.introduction">&lt;&lt; Prev</A></TD><TD><A href="index.html">- Up -</A></TD><TD><A href="node3.html#chapter.gui">Next &gt;&gt;</A></TD></TR></TABLE><HR><ADDRESS>Deny Duchier and Donatien Grolaux<BR><SPAN class="version">Version 1.1.1 (20000613)</SPAN></ADDRESS></BODY></HTML>
