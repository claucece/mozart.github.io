<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>NNTP support library</TITLE><LINK href="http://users.utu.fi/usr/share/mozart/share/doc" rel="stylesheet" type="text/css"></HEAD><BODY><H1 align="center" class="title">NNTP support library</H1><H2 align="center" class="authors">Kari Pahula</H2><BLOCKQUOTE><P>This is a library for communicating with NNTP (network news transport protocol). It also aims to support more protocols. This library is very much work in progress.</P></BLOCKQUOTE><HR><UL class="toc"><LI><A href="index.html#label1">1 General protocol interface</A><UL class="toc"><LI><A href="index.html#label2">1.1 Class <CODE><FONT color="#000000">Protocol</FONT><FONT color="#A020F0">.</FONT><FONT color="#000000">protocol</FONT></CODE></A></LI><LI><A href="index.html#label3">1.2 Creating protocols</A></LI></UL></LI></UL><HR><H1><A name="label1">1 General protocol interface</A></H1><P>This library offers a framework for writing general request/response types of protocols.</P><H2><A name="label2">1.1 Class <CODE><FONT color="#000000">Protocol</FONT><FONT color="#A020F0">.</FONT><FONT color="#000000">protocol</FONT></CODE></A></H2><P>This class offers support for general protocol support. It has the following public methods. </P><DL><DT><CODE><FONT color="#000000">init</FONT></CODE> </DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">init(host:&nbsp;&nbsp;</FONT></CODE><CODE>+<I>HostV</I></CODE><CODE><FONT color="#000000">&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port:&nbsp;&nbsp;</FONT></CODE><CODE>+<I>PortI</I></CODE><CODE><FONT color="#000000">&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reopen:</FONT></CODE><CODE>+<I>ReopenB</I></CODE><CODE><FONT color="#000000">&nbsp;</FONT><FONT color="#A020F0">&lt;=</FONT><FONT color="#000000">&nbsp;</FONT><FONT color="#A020F0">false</FONT></CODE></BLOCKQUOTE><P></P></BLOCKQUOTE></DD><DD><P>Creates a new connection to host <CODE>+<I>HostV</I></CODE> at port <CODE>+<I>PortI</I></CODE>. If <CODE>+<I>ReopenB</I></CODE> is <CODE><FONT color="#A020F0">true</FONT></CODE>, the connection will be reopened if it's lost.</P></DD><DT><CODE><FONT color="#000000">query</FONT></CODE> </DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">query(</FONT></CODE><CODE>+<I>QueriesRs</I></CODE><CODE><FONT color="#000000">)</FONT></CODE></BLOCKQUOTE><P></P></BLOCKQUOTE></DD><DD><P>Processes a list of queries.</P></DD><DT><CODE><FONT color="#000000">request</FONT></CODE> </DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">request(</FONT></CODE><CODE>+<I>QueryR</I></CODE><CODE><FONT color="#000000">)</FONT></CODE></BLOCKQUOTE><P></P></BLOCKQUOTE></DD><DD><P>Processes a single query. Both of these methods take records with arguments passed in bound fields and replies passed in unbound ones. All replies have the field <CODE><FONT color="#000000">status</FONT></CODE> in common with them. Common replies for this are atoms <CODE><FONT color="#000000">ok</FONT></CODE>, for success, and <CODE><FONT color="#000000">closed</FONT></CODE>, for a closed connection. A closed connection cannot be reopened; create a new connection if you want it.</P></DD><DT><CODE><FONT color="#000000">close</FONT></CODE> </DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">close</FONT></CODE></BLOCKQUOTE><P> </P></BLOCKQUOTE></DD><DD><P>Closes the connection.</P></DD><DT><CODE><FONT color="#000000">bytesRead</FONT></CODE> </DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">bytesRead(</FONT></CODE><CODE><I>AmountIs</I></CODE><CODE><FONT color="#000000">)</FONT></CODE></BLOCKQUOTE><P> </P></BLOCKQUOTE></DD><DD><P>Returns the amount of bytes read by this connection so far. This is a list, with the tail bound when more bytes are read.</P></DD><DT><CODE><FONT color="#000000">bytesWritten</FONT></CODE> </DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">bytesWritten(</FONT></CODE><CODE><I>AmountIs</I></CODE><CODE><FONT color="#000000">)</FONT></CODE></BLOCKQUOTE><P> </P></BLOCKQUOTE></DD><DD><P>Returns the amount of bytes written so far. Similar to <CODE><FONT color="#000000">bytesRead</FONT></CODE>.</P></DD></DL><P></P><P><CODE><FONT color="#000000">Protocol</FONT><FONT color="#A020F0">.</FONT><FONT color="#000000">protocol</FONT></CODE> has also the following features. </P><DL><DT><CODE><FONT color="#000000">host</FONT></CODE></DT><DD><P>Host address this protocol object is connected to.</P></DD><DT><CODE><FONT color="#000000">port</FONT></CODE></DT><DD><P>Host port.</P></DD></DL><P></P><H2><A name="label3">1.2 Creating protocols</A></H2><P><CODE><FONT color="#000000">Protocol</FONT><FONT color="#A020F0">.</FONT><FONT color="#000000">protocol</FONT></CODE> can be subclassed. It has some additional methods for this use and requires a few methods. </P><DL><DT><CODE><FONT color="#000000">sendText</FONT></CODE></DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">sendText(vs:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></CODE><CODE>+<I>V</I></CODE><CODE><FONT color="#000000">&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request:</FONT></CODE><CODE>+<I>R</I></CODE><CODE><FONT color="#A020F0">&lt;=</FONT><FONT color="#000000">&nbsp;nil)</FONT></CODE></BLOCKQUOTE><P></P></BLOCKQUOTE></DD><DD><P>Send the text message <CODE>+<I>V</I></CODE> to the host. If <CODE>+<I>R</I></CODE> is not nil, it is passed to the client's port.</P></DD><DT><CODE><FONT color="#000000">parserMsg</FONT></CODE></DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">parserMsg(</FONT></CODE><CODE>+<I>R</I></CODE><CODE><FONT color="#000000">)</FONT></CODE></BLOCKQUOTE><P></P></BLOCKQUOTE></DD><DD><P>Send message <CODE>+<I>R</I></CODE> to the client from the parser.</P></DD><DT><CODE><FONT color="#000000">parserMsg</FONT></CODE></DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">parserMsg(</FONT></CODE><CODE>+<I>R</I></CODE><CODE><FONT color="#000000">)</FONT></CODE></BLOCKQUOTE><P></P></BLOCKQUOTE></DD><DD><P>Send message <CODE>+<I>R</I></CODE> to the parser from the client.</P></DD><DT><CODE><FONT color="#000000">parse</FONT></CODE></DT><DD><BLOCKQUOTE class="synopsis"><P></P><BLOCKQUOTE class="code"><CODE><FONT color="#000000">parse(</FONT></CODE><CODE>+<I>S</I></CODE><CODE><FONT color="#000000">)</FONT></CODE></BLOCKQUOTE><P> </P></BLOCKQUOTE></DD><DD><P>This method has to be defined when implementing new protocols. <CODE>+<I>S</I></CODE> is a list of characters received from the host. The parser typically communicates with the client with <CODE><FONT color="#000000">parserMsg</FONT></CODE>. When the stream is closed, the parser has to call <CODE><FONT color="#000000">parserMsg(closed)</FONT></CODE>. This method will call itself recursively until the connection is closed.</P></DD></DL><P></P><P>Also, the method <CODE><FONT color="#000000">request</FONT></CODE> has to be defined by the subclass.</P><HR><ADDRESS>Kari Pahula<BR><SPAN class="version">Version 1.3.0 (20040430)</SPAN></ADDRESS></BODY></HTML>
